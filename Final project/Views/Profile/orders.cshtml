@using Final_project.Services.Customer
@model PagedResult<order>
@{
    ViewData["Title"] = "Orders";
   
}
<link href="/css/CustomerProfile.css" rel="stylesheet"/>

 

    <div class="container my-4">
        <div class="row">
            <!-- Left Sidebar Navigation -->
           <partial name="_SideBar"/>
            <!-- Main Content Area -->
            <div class="col-md-9">
                <div class="orders-container p-4">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4><i class="fas fa-box-open amazon-orange me-2"></i> Your Orders</h4>
                        <div class="d-flex">
                            <input type="text" id="searchInputOrders" class="form-control me-2" placeholder="Search all orders" style="width: 250px;">
                            <button type="button" id="searchBtn" class="btn btn-amazon">Search Orders</button>
                        </div>
                    </div>

                    <!-- Order Filter -->
                    <div class="order-filter mb-4">
                        <div class="row">
                            <div class="col-md-3 mb-2">
                                <label class="form-label">Orders placed in</label>
                                <select class="form-select" id="orderDate">
                                <option value="all">All time</option>
                                    <option value="30">Last 30 days</option>
                                    <option value="90">Last 3 months</option>
                                    <option value="2023">2023</option>
                                    <option value="2022">2022</option>
                                </select>
                            </div>
                            <div class="col-md-3 mb-2">
                                <label class="form-label">Order status</label>
                                <select class="form-select" id="orderStatus">
                                    <option value="all">All orders</option>
                                    <option value="pending">Pending</option>
                                    <option value="shipped">Shipped</option>
                                    <option value="delivered">Delivered</option>
                                    <option value="cancelled">Cancelled</option>
                                </select>
                            </div>
                            <div class="col-md-3 mb-2">
                            <partial name="_FormPagination"/>
                            </div>
                        </div>
                    </div>

                    <!-- Order List -->
                <div id="orderResults">                 
                    <partial name="_OrdersList" />
                </div>
                               

                <!-- Pagination -->
                <partial name="_Pagination" />
                </div>
            </div>
        </div>
    </div>

    
<!-- Back to Top Button -->
<partial name="_BackToTopBtn" />

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

   <script>
           document.addEventListener('DOMContentLoaded', function () {

        // Search on Enter
        document.getElementById('searchInputOrders').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                const searchValue = this.value;
                filterOrders('search', searchValue);
            }
        });
        //search button
        document.getElementById('searchBtn').addEventListener('click',function(){
            const searchValue = document.getElementById('searchInputOrders').value;
                filterOrders('search', searchValue);
        })
        // Order Date Filter
        document.getElementById('orderDate').addEventListener('change', function () {
            const selected = this.value;
            filterOrders('dateFilter', selected);
        });

        // Status Filter
        document.getElementById('orderStatus').addEventListener('change', function () {
            const selected = this.value;
            filterOrders('statusFilter', selected);
        });

    });//end of load


            function filterOrders(filterName, value) 
            {
               
                    console.log(filterName);
                    console.log(value);
                $.ajax({
                    url: `/Profile/Orders?${filterName}=${value}`, 
                    success: function (response) 
                    {
                        $('#orderResults').html(response);
                    },
                    error: function (res) 
                    {
                        alert("Error: " + res.responseText);
                    }
                });
            }


 


      
   </script>